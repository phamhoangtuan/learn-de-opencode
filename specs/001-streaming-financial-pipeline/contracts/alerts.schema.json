{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://learn-de.local/schemas/alerts/v1.0.0",
  "title": "Alert",
  "description": "Alert record generated by the Flink stream processor when a transaction matches an alerting rule. Published to the Kafka alerts topic and persisted to the Iceberg alerts table.",
  "type": "object",
  "required": [
    "alert_id",
    "transaction_id",
    "rule_name",
    "severity",
    "alert_timestamp",
    "description"
  ],
  "additionalProperties": false,
  "properties": {
    "alert_id": {
      "type": "string",
      "format": "uuid",
      "description": "Globally unique alert identifier (UUID v4)",
      "examples": ["a1b2c3d4-e5f6-7890-abcd-ef1234567890"]
    },
    "transaction_id": {
      "type": "string",
      "format": "uuid",
      "description": "Reference to the transaction that triggered this alert (FK→Transaction)",
      "examples": ["550e8400-e29b-41d4-a716-446655440000"]
    },
    "rule_name": {
      "type": "string",
      "minLength": 1,
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "Slug-format identifier of the alerting rule that triggered (FK→AlertingRule)",
      "examples": ["high-value-transaction", "rapid-activity", "unusual-hour"]
    },
    "severity": {
      "type": "string",
      "enum": ["low", "medium", "high", "critical"],
      "description": "Alert severity level"
    },
    "alert_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When the alert was generated by Flink, ISO 8601 with timezone",
      "examples": ["2026-02-16T14:30:02.500Z"]
    },
    "description": {
      "type": "string",
      "minLength": 1,
      "maxLength": 500,
      "description": "Human-readable explanation of why the alert fired",
      "examples": [
        "Transaction amount $12,500.00 exceeds threshold of $10,000",
        "Account ACC123456789 produced 7 transactions within 1-minute window",
        "Transaction at 02:30 UTC falls within quiet hours (01:00-05:00)"
      ]
    }
  }
}
